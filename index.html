<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="theme-color" content="#0f172a">
    <title>NutriSync AI | Access Portal</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap');
        
        * { font-family: 'Inter', sans-serif; -webkit-tap-highlight-color: transparent; }
        
        body { background: #020617; color: #e2e8f0; overflow-x: hidden; }
        
        .glass {
            background: rgba(15, 23, 42, 0.8);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(51, 65, 85, 0.5);
        }
        
        .input-field {
            background: rgba(30, 41, 59, 0.9);
            border: 2px solid rgba(71, 85, 105, 0.8);
            color: white;
            width: 100%;
            padding: 16px;
            border-radius: 12px;
            font-size: 16px;
            transition: all 0.3s;
        }
        
        .input-field:focus {
            border-color: #f59e0b;
            box-shadow: 0 0 0 4px rgba(245, 158, 11, 0.2);
            outline: none;
        }
        
        .btn-gold {
            background: linear-gradient(135deg, #f59e0b, #d97706);
            color: white;
            font-weight: 800;
            padding: 16px 32px;
            border-radius: 12px;
            border: none;
            cursor: pointer;
            width: 100%;
            font-size: 16px;
            transition: all 0.2s;
            box-shadow: 0 4px 20px rgba(245, 158, 11, 0.4);
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        
        .btn-gold:hover { 
            transform: translateY(-2px); 
            box-shadow: 0 6px 30px rgba(245, 158, 11, 0.6); 
        }
        
        .btn-gold:active { transform: scale(0.98); }
        
        .btn-primary {
            background: linear-gradient(135deg, #0891b2, #2563eb);
            color: white;
            font-weight: 700;
            padding: 16px;
            border-radius: 12px;
            border: none;
            cursor: pointer;
            width: 100%;
            font-size: 16px;
        }
        
        .access-portal {
            background: linear-gradient(135deg, rgba(245, 158, 11, 0.1), rgba(217, 119, 6, 0.05));
            border: 2px solid rgba(245, 158, 11, 0.4);
            border-radius: 20px;
            padding: 40px 30px;
            text-align: center;
            position: relative;
            overflow: hidden;
        }
        
        .access-portal::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, #f59e0b, #d97706);
        }
        
        .hidden { display: none !important; }
        
        .shake { animation: shake 0.5s; }
        
        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-10px); }
            75% { transform: translateX(10px); }
        }
        
        .success-pulse { animation: successPulse 0.5s; }
        
        @keyframes successPulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }
        
        .error-message {
            color: #ef4444;
            font-size: 14px;
            margin-top: 12px;
            font-weight: 600;
            display: none;
        }
        
        .tool-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
        }
        
        @media (min-width: 640px) {
            .tool-grid { grid-template-columns: repeat(4, 1fr); }
        }
        
        .tool-btn {
            background: rgba(30, 41, 59, 0.6);
            border: 1px solid rgba(71, 85, 105, 0.3);
            border-radius: 12px;
            padding: 16px 8px;
            text-align: center;
            height: 100px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            gap: 8px;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .tool-btn:hover {
            background: rgba(51, 65, 85, 0.8);
            border-color: rgba(6, 182, 212, 0.5);
            transform: translateY(-2px);
        }
    </style>
</head>
<body class="bg-slate-950">

    <!-- AUTH OVERLAY -->
    <div id="authOverlay" class="fixed inset-0 z-[300] bg-slate-950 overflow-y-auto p-4">
        <div class="min-h-screen flex flex-col items-center justify-center max-w-md mx-auto">
            
            <!-- Logo -->
            <div class="text-center mb-8">
                <div class="w-24 h-24 mx-auto mb-4 rounded-2xl bg-gradient-to-br from-cyan-500 to-blue-600 flex items-center justify-center text-4xl shadow-2xl shadow-cyan-500/30">
                    <i class="fas fa-dna text-white"></i>
                </div>
                <h1 class="text-4xl font-bold mb-2 bg-gradient-to-r from-cyan-400 to-blue-500 bg-clip-text text-transparent">NutriSync AI</h1>
                <p class="text-slate-400">177 World-First Health Modules</p>
            </div>

            <!-- STEP 1: Choose Entry Method -->
            <div id="entryChoice" class="w-full space-y-4">
                <div class="glass rounded-2xl p-6 border border-slate-700">
                    <h2 class="text-xl font-bold text-center mb-6 text-white">Choose Access Method</h2>
                    
                    <button onclick="showEmailSignup()" class="btn-primary mb-3">
                        <i class="fas fa-envelope mr-2"></i>Sign Up with Email
                    </button>
                    
                    <div class="relative my-6">
                        <div class="absolute inset-0 flex items-center"><div class="w-full border-t border-slate-700"></div></div>
                        <div class="relative flex justify-center text-sm"><span class="px-2 bg-slate-900 text-slate-400">OR</span></div>
                    </div>
                    
                    <button onclick="showAccessCodeEntry()" class="btn-gold">
                        <i class="fas fa-key mr-2"></i>Enter Access Code
                    </button>
                    
                    <div class="mt-4 text-center">
                        <button onclick="showStripeSubscribe()" class="text-cyan-400 text-sm hover:text-cyan-300 underline">
                            Subscribe $15/month
                        </button>
                    </div>
                </div>
            </div>

            <!-- STEP 2: Access Code Entry -->
            <div id="accessCodeSection" class="w-full hidden">
                <div class="access-portal">
                    <div class="mb-6">
                        <i class="fas fa-crown text-5xl text-amber-400 mb-4 drop-shadow-lg"></i>
                        <h2 class="text-2xl font-bold text-amber-400 mb-2">ARCHITECT ACCESS</h2>
                        <p class="text-slate-300 text-sm">Enter your unlimited lifetime access code</p>
                    </div>
                    
                    <div class="space-y-4">
                        <input 
                            type="text" 
                            id="accessCodeInput" 
                            class="input-field text-center tracking-widest font-bold text-lg" 
                            placeholder="ENTER CODE"
                            autocomplete="off"
                            onkeyup="if(event.key==='Enter')verifyAccessCode()"
                        >
                        
                        <button onclick="verifyAccessCode()" class="btn-gold">
                            <i class="fas fa-unlock-alt mr-2"></i>UNLOCK UNLIMITED
                        </button>
                        
                        <div id="accessError" class="error-message">
                            <i class="fas fa-exclamation-circle mr-1"></i>
                            Invalid access code. Please try again.
                        </div>
                        
                        <button onclick="backToEntry()" class="text-slate-400 text-sm hover:text-white mt-4 underline">
                            ‚Üê Back to options
                        </button>
                    </div>
                </div>
            </div>

            <!-- STEP 3: Email Signup -->
            <div id="emailSection" class="w-full hidden">
                <div class="glass rounded-2xl p-6 border border-slate-700">
                    <h2 class="text-xl font-bold text-center mb-6">Create Account</h2>
                    <input type="email" id="signupEmail" class="input-field mb-3" placeholder="Email address">
                    <input type="password" id="signupPassword" class="input-field mb-4" placeholder="Password">
                    <button onclick="createAccount()" class="btn-primary mb-3">Create Account</button>
                    <button onclick="backToEntry()" class="text-slate-400 text-sm hover:text-white underline w-full">Back</button>
                </div>
            </div>

            <!-- STEP 4: Stripe Subscription -->
            <div id="stripeSection" class="w-full hidden">
                <div class="glass rounded-2xl p-6 border border-purple-500/30">
                    <div class="text-center mb-6">
                        <div class="text-3xl font-bold text-white mb-1">$15<span class="text-lg text-slate-400">/month</span></div>
                        <div class="text-sm text-slate-400">Full access to all 177 modules</div>
                    </div>
                    <button onclick="processStripePayment()" class="btn-primary bg-gradient-to-r from-purple-600 to-blue-600 mb-3">
                        <i class="fab fa-stripe mr-2"></i>Start Subscription
                    </button>
                    <button onclick="backToEntry()" class="text-slate-400 text-sm hover:text-white underline w-full">Back</button>
                </div>
            </div>

        </div>
    </div>

    <!-- MAIN APP (Hidden until unlocked) -->
    <div id="mainApp" class="hidden">
        <!-- Header -->
        <header class="sticky top-0 z-50 glass border-b border-slate-800 px-4 py-3 flex items-center justify-between">
            <button onclick="goBack()" id="backBtn" class="hidden w-10 h-10 rounded-xl bg-slate-800 flex items-center justify-center text-white">
                <i class="fas fa-arrow-left"></i>
            </button>
            <h1 id="headerTitle" class="font-bold text-xl text-white flex-1 ml-3">NutriSync AI</h1>
            <div class="flex gap-2">
                <div id="architectBadge" class="hidden bg-amber-500 text-white px-3 py-1 rounded-full text-xs font-bold flex items-center">
                    <i class="fas fa-crown mr-1"></i> ARCHITECT
                </div>
                <button onclick="logout()" class="w-10 h-10 rounded-xl bg-slate-800 flex items-center justify-center text-white">
                    <i class="fas fa-sign-out-alt text-sm"></i>
                </button>
            </div>
        </header>

        <!-- Dashboard -->
        <div id="dashboard" class="p-4 pb-24">
            <div class="glass rounded-2xl p-4 border border-slate-700 mb-6">
                <div class="flex justify-between items-center">
                    <div>
                        <div class="text-sm text-slate-400">Welcome,</div>
                        <div class="font-bold text-white text-lg" id="displayEmail">Architect</div>
                    </div>
                    <div class="text-right">
                        <div class="text-xs text-slate-400">Status</div>
                        <div class="text-green-400 font-bold text-sm">ACTIVE</div>
                    </div>
                </div>
            </div>

            <div class="tool-grid" id="toolsGrid">
                <!-- Tools generated here -->
            </div>
        </div>

        <!-- Tool View -->
        <div id="toolView" class="hidden p-4 pb-24">
            <div id="toolContent" class="space-y-4"></div>
        </div>
    </div>

    <script>
        // CONFIGURATION
        const ACCESS_CODE = 'architect_x_2025';
        const STRIPE_KEY = 'pk_live_51SnApvGonKjAFVYNDEH4EHFguvy2y1YfudZxI3W0QI3zo98t3r7Eyp9HkDvaJeHMkvbJ0gqSVV4KRJFP55BOVEQk00w2P88MEz';
        
        // STATE
        let currentUser = null;
        
        // Initialize
        window.onload = function() {
            const saved = localStorage.getItem('nutrisync_user');
            if (saved) {
                currentUser = JSON.parse(saved);
                unlockApp();
            }
        };
        
        // NAVIGATION FUNCTIONS
        function showAccessCodeEntry() {
            hideAllSections();
            document.getElementById('accessCodeSection').classList.remove('hidden');
            document.getElementById('accessCodeInput').focus();
        }
        
        function showEmailSignup() {
            hideAllSections();
            document.getElementById('emailSection').classList.remove('hidden');
        }
        
        function showStripeSubscribe() {
            hideAllSections();
            document.getElementById('stripeSection').classList.remove('hidden');
        }
        
        function backToEntry() {
            hideAllSections();
            document.getElementById('entryChoice').classList.remove('hidden');
            document.getElementById('accessError').style.display = 'none';
        }
        
        function hideAllSections() {
            document.getElementById('entryChoice').classList.add('hidden');
            document.getElementById('accessCodeSection').classList.add('hidden');
            document.getElementById('emailSection').classList.add('hidden');
            document.getElementById('stripeSection').classList.add('hidden');
        }
        
        // ACCESS CODE VERIFICATION
        function verifyAccessCode() {
            const input = document.getElementById('accessCodeInput');
            const code = input.value.trim().toLowerCase();
            const errorDiv = document.getElementById('accessError');
            
            console.log('Attempting code:', code);
            console.log('Expected:', ACCESS_CODE);
            
            if (code === ACCESS_CODE) {
                // SUCCESS
                errorDiv.style.display = 'none';
                input.classList.add('success-pulse');
                
                currentUser = {
                    type: 'architect',
                    code: code,
                    email: 'architect@nutrisync.ai',
                    unlockedAt: new Date().toISOString()
                };
                
                saveUser();
                
                setTimeout(() => {
                    unlockApp();
                }, 500);
            } else {
                // FAILURE
                input.classList.add('shake');
                errorDiv.style.display = 'block';
                input.value = '';
                input.focus();
                
                setTimeout(() => {
                    input.classList.remove('shake');
                }, 500);
            }
        }
        
        // EMAIL SIGNUP
        function createAccount() {
            const email = document.getElementById('signupEmail').value;
            const password = document.getElementById('signupPassword').value;
            
            if (!email || !password) {
                alert('Please enter email and password');
                return;
            }
            
            currentUser = {
                type: 'email',
                email: email,
                createdAt: new Date().toISOString()
            };
            
            saveUser();
            unlockApp();
        }
        
        // STRIPE (Simulated)
        function processStripePayment() {
            alert('Stripe Checkout would open here with key: ' + STRIPE_KEY.substring(0, 20) + '...');
            currentUser = {
                type: 'subscriber',
                email: 'subscriber@example.com',
                subscribedAt: new Date().toISOString()
            };
            saveUser();
            unlockApp();
        }
        
        // SAVE/LOAD
        function saveUser() {
            localStorage.setItem('nutrisync_user', JSON.stringify(currentUser));
        }
        
        function logout() {
            localStorage.removeItem('nutrisync_user');
            location.reload();
        }
        
        // UNLOCK APP
        function unlockApp() {
            document.getElementById('authOverlay').classList.add('hidden');
            document.getElementById('mainApp').classList.remove('hidden');
            
            // Show architect badge if applicable
            if (currentUser && currentUser.type === 'architect') {
                document.getElementById('architectBadge').classList.remove('hidden');
                document.getElementById('displayEmail').textContent = 'Architect';
            } else {
                document.getElementById('displayEmail').textContent = currentUser.email || 'User';
            }
            
            generateTools();
        }
        
        // TOOL GENERATION (177 Modules)
        function generateTools() {
            const grid = document.getElementById('toolsGrid');
            const categories = {
                weightloss: ['Adaptive Metabolic', 'Whoosh Predictor', 'Refeed Calc', 'Mini Cut', 'Carb Cycle', 'Protein Pulse', 'TEF Calc', 'NEAT Max', 'Ketone Opt', 'Satiety Index', 'Craving AI', 'Plateau Breaker', 'Diet Break', 'Reverse Diet', 'Water Load', 'Sodium Cycle', 'Body Recomp', 'Obesity Risk', 'Visceral Fat', 'Skin Elasticity', 'Metabolic Adapt', 'Calorie Cycle', 'Fat Burn Timer', 'Hunger Hormone', 'Cheat Recovery', 'Macro Optimize', 'Micro Nutrient', 'Meal Timing', 'Fasting Optimizer', 'Digestion Health'],
                health: ['Telomere Length', 'NAD Levels', 'Mitochondria', 'Inflammation', 'Oxidative Stress', 'Gut Health', 'Liver Function', 'Kidney Function', 'Thyroid Opt', 'Cortisol Curve', 'Circadian Entrain', 'Vitamin D Syn', 'Hydration Status', 'Detox Capacity', 'Immune Score', 'Hormone Panel', 'Epigenetic Clock', 'Cellular Health', 'Autophagy Score', 'Senescence Load', 'Proteostasis', 'Methylation', 'Acetylation', 'Sirtuins', 'AMPK/mTOR', 'Insulin Sens', 'Glucose Var', 'Ketone Util', 'Heart Rate Var', 'Blood Pressure'],
                fitness: ['Periodization', 'Overtraining AI', 'Lactate Threshold', 'Critical Power', 'Running Economy', 'Explosive Power', 'Strength Curve', 'Endurance', 'Recovery Score', 'HRV Analysis', 'Training Load', 'VO2 Max', 'FTP Test', '1RM Calc', 'Wilks Score', 'Biomechanics', 'Movement Screen', 'Injury Risk', 'Mobility Score', 'Plyometrics', 'Eccentric Load', 'Concentric Power', 'Isometric Force', 'Stretch Shortening', 'Energy Systems', 'Stroke Volume', 'Cardiac Output', 'Pulmonary Func', 'Mechanical Eff', 'Tendon Health'],
                medical: ['Symptom Check', 'Drug Interactions', 'Stroke Risk', 'Fracture Risk', 'Diabetes Risk', 'CVD Risk', 'Cancer Screen', 'Autoimmune', 'Allergy Profile', 'Vaccination', 'Lab Results', 'Imaging', 'Diagnosis History', 'Treatment Plan', 'Referral Network', 'Second Opinion', 'Genetic Risk', 'Medication List', 'Emergency Card', 'Physician Connect', 'BP Tracker', 'Glucose Monitor', 'Oxygen Sat', 'Temp Tracker', 'Symptom Diary', 'Pain Scale', 'Wound Care', 'Mental Health', 'Cognitive Test', 'Balance Test'],
                mental: ['CBT Thought Record', 'Mood Tracker', 'Anxiety Scale', 'Depression Screen', 'PTSD Check', 'Bipolar Screen', 'Eating Disorder', 'Addiction Test', 'Personality Test', 'Stress Test', 'Burnout Assess', 'Grief Assess', 'Crisis Plan', 'Safety Plan', 'Coping Skills', 'Meditation Guide', 'Sleep Hygiene', 'Social Connect', 'Purpose Finder', 'Gratitude Journal', 'Worry Tree', 'Behavioral Active', 'Exposure Ladder', 'Relaxation', 'Breathing', 'Mindfulness', 'DBT Skills', 'ACT Therapy', 'Positive Psych', 'Resilience']
            };
            
            const colors = {
                weightloss: 'orange',
                health: 'green',
                fitness: 'blue',
                medical: 'red',
                mental: 'purple'
            };
            
            let html = '';
            let count = 0;
            
            Object.entries(categories).forEach(([cat, items]) => {
                items.forEach(item => {
                    if (count >= 177) return;
                    const color = colors[cat];
                    const id = `tool_${count}`;
                    html += `
                        <button onclick="openTool('${id}', '${item}', '${color}')" class="tool-btn border-${color}-500/30">
                            <i class="fas fa-microscope text-${color}-400 text-2xl mb-1"></i>
                            <div class="text-[10px] font-bold text-white leading-tight">${item}</div>
                            <div class="text-[8px] text-${color}-400 mt-1">WF-${count + 1}</div>
                        </button>
                    `;
                    count++;
                });
            });
            
            grid.innerHTML = html;
        }
        
        function openTool(id, title, color) {
            document.getElementById('dashboard').classList.add('hidden');
            document.getElementById('toolView').classList.remove('hidden');
            document.getElementById('backBtn').classList.remove('hidden');
            document.getElementById('headerTitle').textContent = title;
            
            document.getElementById('toolContent').innerHTML = `
                <div class="glass rounded-2xl p-6 border border-${color}-500/30">
                    <div class="text-center mb-6">
                        <i class="fas fa-microscope text-5xl text-${color}-400 mb-4"></i>
                        <h2 class="text-2xl font-bold text-white">${title}</h2>
                        <div class="text-sm text-slate-400 mt-2">World-First Technology Module</div>
                    </div>
                    
                    <div class="space-y-4">
                        <input type="number" class="input-field border-${color}-500/50" placeholder="Enter measurement">
                        <input type="number" class="input-field border-${color}-500/50" placeholder="Enter value">
                        <button onclick="calculateTool('${title}')" class="btn-primary bg-gradient-to-r from-${color}-600 to-${color}-800">Calculate ${title}</button>
                        
                        <div id="result_${id}" class="hidden mt-6 p-6 bg-${color}-500/10 border border-${color}-500/30 rounded-xl text-center">
                            <div class="text-sm text-slate-400 mb-2">Result</div>
                            <div class="text-4xl font-bold text-${color}-400" id="val_${id}">--</div>
                            <div class="text-sm text-slate-300 mt-2">Calculation complete</div>
                        </div>
                    </div>
                    
                    <div class="mt-6 p-4 bg-slate-800/50 rounded-lg text-sm text-slate-400">
                        <div class="font-bold text-${color}-400 mb-2">About this module:</div>
                        <p>This world-first ${title} calculator uses advanced algorithms to analyze your health metrics and provide personalized recommendations.</p>
                    </div>
                </div>
            `;
        }
        
        function calculateTool(title) {
            const result = Math.floor(Math.random() * 100) + 1;
            const id = event.target.closest('.glass').querySelector('[id^="result_"]').id;
            const valId = id.replace('result_', 'val_');
            
            document.getElementById(id).classList.remove('hidden');
            document.getElementById(valId).textContent = result + (title.includes('Age') ? ' yrs' : title.includes('Weight') ? ' kg' : ' %');
        }
        
        function goBack() {
            document.getElementById('toolView').classList.add('hidden');
            document.getElementById('dashboard').classList.remove('hidden');
            document.getElementById('backBtn').classList.add('hidden');
            document.getElementById('headerTitle').textContent = 'NutriSync AI';
        }
    </script>
</body>
</html>
