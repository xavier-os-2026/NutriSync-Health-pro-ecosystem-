
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NutriSync | World's First Clinical Health Ecosystem</title>
    <script src="https://js.stripe.com/v3/"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary: #0066FF;
            --secondary: #00D4AA;
            --accent: #7C3AED;
            --danger: #FF4757;
            --warning: #FFA502;
            --dark: #0F172A;
            --dark-light: #1E293B;
            --gradient-1: linear-gradient(135deg, #0066FF 0%, #00D4AA 100%);
            --gradient-2: linear-gradient(135deg, #7C3AED 0%, #0066FF 100%);
            --gradient-premium: linear-gradient(135deg, #FFD700 0%, #FFA502 100%);
        }
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Inter', sans-serif; background: var(--dark); color: white; overflow-x: hidden; }
        .bg-animation { position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: -1; background: radial-gradient(circle at 20% 50%, rgba(0, 102, 255, 0.15) 0%, transparent 50%), radial-gradient(circle at 80% 80%, rgba(0, 212, 170, 0.15) 0%, transparent 50%), radial-gradient(circle at 40% 20%, rgba(124, 58, 237, 0.15) 0%, transparent 50%); }
        .app-container { display: grid; grid-template-columns: 280px 1fr; min-height: 100vh; }
        .sidebar { background: rgba(15, 23, 42, 0.95); backdrop-filter: blur(20px); border-right: 1px solid rgba(255,255,255,0.1); display: flex; flex-direction: column; position: fixed; height: 100vh; width: 280px; z-index: 100; overflow-y: auto; }
        .brand { padding: 1.5rem; border-bottom: 1px solid rgba(255,255,255,0.1); display: flex; align-items: center; gap: 0.75rem; }
        .brand-icon { width: 45px; height: 45px; background: var(--gradient-1); border-radius: 12px; display: flex; align-items: center; justify-content: center; font-size: 1.5rem; box-shadow: 0 10px 20px rgba(0,102,255,0.3); }
        .brand-text h1 { font-size: 1.5rem; font-weight: 800; background: var(--gradient-1); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
        .brand-text span { font-size: 0.7rem; color: rgba(255,255,255,0.5); letter-spacing: 0.1em; }
        .nav-section { padding: 0.5rem 1rem; margin-top: 1rem; font-size: 0.7rem; text-transform: uppercase; letter-spacing: 0.1em; color: rgba(255,255,255,0.4); font-weight: 700; }
        .nav-item { display: flex; align-items: center; gap: 0.875rem; padding: 0.875rem 1.25rem; margin: 0.25rem 0.75rem; border-radius: 10px; cursor: pointer; transition: all 0.3s; color: rgba(255,255,255,0.7); font-size: 0.9rem; font-weight: 500; position: relative; }
        .nav-item:hover { background: rgba(255,255,255,0.05); color: white; transform: translateX(5px); }
        .nav-item.active { background: rgba(0, 102, 255, 0.2); color: var(--primary); border: 1px solid rgba(0, 102, 255, 0.3); }
        .nav-item.premium::after { content: 'PRO'; margin-left: auto; font-size: 0.6rem; padding: 0.25rem 0.5rem; background: var(--gradient-premium); color: black; border-radius: 20px; font-weight: 800; }
        .nav-item.unlocked { color: #FFD700; }
        .nav-item.unlocked::after { content: 'âœ“'; margin-left: auto; font-size: 0.8rem; color: var(--secondary); }
        .feature-count { margin-top: auto; padding: 1.5rem; }
        .feature-count-box { padding: 1rem; background: rgba(0,0,0,0.3); border-radius: 12px; border: 1px solid rgba(255,255,255,0.1); }
        .feature-count h4 { font-size: 0.875rem; color: rgba(255,255,255,0.6); margin-bottom: 0.5rem; }
        .feature-count .number { font-size: 2rem; font-weight: 800; background: var(--gradient-1); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
        .main-content { margin-left: 280px; padding: 2rem; max-width: 1600px; }
        .top-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 2rem; padding-bottom: 1.5rem; border-bottom: 1px solid rgba(255,255,255,0.1); }
        .page-title h2 { font-size: 2.5rem; font-weight: 800; margin-bottom: 0.25rem; }
        .page-title p { color: rgba(255,255,255,0.5); font-size: 1rem; }
        .header-actions { display: flex; gap: 1rem; align-items: center; }
        .btn { display: inline-flex; align-items: center; gap: 0.5rem; padding: 0.75rem 1.5rem; border-radius: 10px; font-size: 0.9rem; font-weight: 600; cursor: pointer; transition: all 0.3s; border: none; outline: none; }
        .btn-primary { background: var(--gradient-1); color: white; box-shadow: 0 10px 20px rgba(0,102,255,0.3); }
        .btn-primary:hover { transform: translateY(-2px); box-shadow: 0 15px 30px rgba(0,102,255,0.4); }
        .btn-premium { background: var(--gradient-premium); color: black; font-weight: 700; }
        .btn-glass { background: rgba(255,255,255,0.1); color: white; border: 1px solid rgba(255,255,255,0.2); }
        .btn-glass:hover { background: rgba(255,255,255,0.2); }
        .btn-success { background: var(--secondary); color: black; }
        .stats-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 1.5rem; margin-bottom: 2rem; }
        .stat-card { background: rgba(30, 41, 59, 0.8); backdrop-filter: blur(10px); border: 1px solid rgba(255,255,255,0.1); border-radius: 16px; padding: 1.5rem; position: relative; overflow: hidden; }
        .stat-card::before { content: ''; position: absolute; top: 0; left: 0; right: 0; height: 3px; background: var(--gradient-1); }
        .stat-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem; }
        .stat-label { font-size: 0.875rem; color: rgba(255,255,255,0.5); font-weight: 500; }
        .stat-icon { width: 40px; height: 40px; border-radius: 10px; display: flex; align-items: center; justify-content: center; font-size: 1.25rem; }
        .stat-icon.blue { background: rgba(0, 102, 255, 0.2); color: var(--primary); }
        .stat-icon.green { background: rgba(0, 212, 170, 0.2); color: var(--secondary); }
        .stat-icon.purple { background: rgba(124, 58, 237, 0.2); color: var(--accent); }
        .stat-icon.orange { background: rgba(255, 165, 2, 0.2); color: var(--warning); }
        .stat-value { font-size: 2.5rem; font-weight: 800; margin-bottom: 0.5rem; min-height: 3rem; display: flex; align-items: center; }
        .stat-value.loading { color: rgba(255,255,255,0.2); font-size: 1.5rem; }
        .stat-change { font-size: 0.875rem; display: flex; align-items: center; gap: 0.25rem; color: rgba(255,255,255,0.4); }
        .module-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 1.5rem; }
        .module-card { background: rgba(30, 41, 59, 0.6); backdrop-filter: blur(10px); border: 1px solid rgba(255,255,255,0.1); border-radius: 20px; padding: 1.5rem; position: relative; transition: all 0.3s; }
        .module-card:hover { transform: translateY(-5px); border-color: rgba(255,255,255,0.2); box-shadow: 0 20px 40px rgba(0,0,0,0.3); }
        .module-card.wide { grid-column: span 2; }
        .module-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 1.5rem; }
        .module-title { display: flex; align-items: center; gap: 0.75rem; }
        .module-icon { width: 50px; height: 50px; border-radius: 12px; display: flex; align-items: center; justify-content: center; font-size: 1.5rem; background: var(--gradient-1); }
        .module-title h3 { font-size: 1.25rem; font-weight: 700; }
        .world-first-badge { display: inline-flex; align-items: center; gap: 0.5rem; padding: 0.5rem 1rem; background: linear-gradient(135deg, #FFD700 0%, #FFA502 100%); color: black; border-radius: 50px; font-size: 0.75rem; font-weight: 800; margin-bottom: 1rem; }
        .empty-state { padding: 3rem; text-align: center; color: rgba(255,255,255,0.4); }
        .empty-state i { font-size: 3rem; margin-bottom: 1rem; opacity: 0.3; }
        .breathing-container { display: flex; flex-direction: column; align-items: center; justify-content: center; min-height: 300px; position: relative; }
        .breath-circle { width: 200px; height: 200px; border-radius: 50%; background: var(--gradient-1); display: flex; align-items: center; justify-content: center; font-size: 1.5rem; font-weight: 700; position: relative; box-shadow: 0 0 60px rgba(0, 102, 255, 0.5); animation: breathe 8s infinite ease-in-out; }
        @keyframes breathe { 0%, 100% { transform: scale(1); opacity: 0.8; } 50% { transform: scale(1.3); opacity: 1; box-shadow: 0 0 100px rgba(0, 212, 170, 0.6); } }
        .breath-controls { display: flex; gap: 1rem; margin-top: 2rem; }
        .breath-btn { padding: 0.75rem 1.5rem; background: rgba(255,255,255,0.1); border: 1px solid rgba(255,255,255,0.2); border-radius: 50px; color: white; cursor: pointer; transition: all 0.3s; }
        .breath-btn.active { background: var(--primary); border-color: var(--primary); }
        .workout-categories { display: grid; grid-template-columns: repeat(3, 1fr); gap: 1rem; margin-top: 1rem; }
        .workout-cat { padding: 1.5rem; background: rgba(0,0,0,0.3); border-radius: 12px; text-align: center; cursor: pointer; transition: all 0.3s; border: 1px solid rgba(255,255,255,0.05); opacity: 0.6; }
        .workout-cat:hover { opacity: 1; background: rgba(255,255,255,0.05); transform: translateY(-3px); border-color: var(--primary); }
        .workout-cat i { font-size: 2rem; margin-bottom: 0.75rem; display: block; }
        .premium-overlay { position: absolute; inset: 0; background: rgba(15, 23, 42, 0.95); backdrop-filter: blur(10px); border-radius: 20px; display: flex; flex-direction: column; align-items: center; justify-content: center; z-index: 10; gap: 1rem; text-align: center; padding: 2rem; transition: opacity 0.3s; }
        .premium-overlay.hidden-overlay { opacity: 0; pointer-events: none; }
        .premium-icon { font-size: 3rem; background: var(--gradient-premium); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
        .modal-overlay { position: fixed; inset: 0; background: rgba(0,0,0,0.8); backdrop-filter: blur(10px); display: none; align-items: center; justify-content: center; z-index: 1000; }
        .modal-overlay.active { display: flex; }
        .modal { background: var(--dark-light); border: 1px solid rgba(255,255,255,0.1); border-radius: 24px; width: 90%; max-width: 600px; max-height: 90vh; overflow-y: auto; }
        .modal-header { padding: 2rem; border-bottom: 1px solid rgba(255,255,255,0.1); display: flex; justify-content: space-between; align-items: center; }
        .modal-header h2 { font-size: 1.75rem; font-weight: 800; }
        .pricing-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 1.5rem; padding: 2rem; }
        .pricing-card { border: 2px solid rgba(255,255,255,0.1); border-radius: 16px; padding: 2rem; cursor: pointer; transition: all 0.3s; position: relative; }
        .pricing-card:hover { border-color: var(--primary); }
        .pricing-card.selected { border-color: var(--primary); background: rgba(0, 102, 255, 0.1); }
        .pricing-card.popular::before { content: 'MOST POPULAR'; position: absolute; top: -12px; left: 50%; transform: translateX(-50%); background: var(--gradient-premium); color: black; padding: 0.5rem 1rem; border-radius: 20px; font-size: 0.75rem; font-weight: 800; }
        .price { font-size: 3rem; font-weight: 800; margin: 1rem 0; }
        .access-code-section { margin: 1rem 2rem; padding: 1.5rem; background: rgba(0,0,0,0.3); border-radius: 12px; border: 1px dashed rgba(255,215,0,0.3); }
        .access-code-section h3 { color: #FFD700; margin-bottom: 0.5rem; font-size: 1rem; }
        .access-input { width: 100%; padding: 0.875rem; background: rgba(255,255,255,0.1); border: 1px solid rgba(255,255,255,0.2); border-radius: 8px; color: white; font-size: 1rem; text-align: center; letter-spacing: 0.1em; margin-bottom: 0.75rem; }
        .access-input:focus { outline: none; border-color: #FFD700; }
        #card-element { padding: 1rem; background: rgba(0,0,0,0.3); border: 1px solid rgba(255,255,255,0.2); border-radius: 8px; margin: 1rem 0; }
        .hidden { display: none !important; }
        .connect-device-btn { width: 100%; padding: 0.75rem; background: rgba(0,0,0,0.3); border: 1px dashed rgba(255,255,255,0.2); border-radius: 8px; color: rgba(255,255,255,0.6); cursor: pointer; transition: all 0.3s; margin-top: 1rem; }
        .connect-device-btn:hover { border-color: var(--secondary); color: var(--secondary); }
        
        /* Profile Form Styles */
        .profile-form { display: grid; gap: 1rem; }
        .form-group { display: flex; flex-direction: column; gap: 0.5rem; }
        .form-group label { font-size: 0.875rem; color: rgba(255,255,255,0.7); font-weight: 500; }
        .form-group input { padding: 0.75rem 1rem; background: rgba(0,0,0,0.3); border: 1px solid rgba(255,255,255,0.2); border-radius: 8px; color: white; font-size: 1rem; }
        .form-group input:focus { outline: none; border-color: var(--primary); }
        .form-row { display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; }
        .chart-container { background: rgba(0,0,0,0.3); border-radius: 12px; padding: 1rem; margin-top: 1rem; height: 300px; }
        .metric-cards { display: grid; grid-template-columns: repeat(4, 1fr); gap: 1rem; margin-bottom: 1rem; }
        .metric-card { background: rgba(0,0,0,0.3); padding: 1rem; border-radius: 12px; text-align: center; border: 1px solid rgba(255,255,255,0.1); }
        .metric-value { font-size: 1.5rem; font-weight: 700; color: var(--secondary); }
        .metric-label { font-size: 0.75rem; color: rgba(255,255,255,0.5); margin-top: 0.25rem; }
        
        @media (max-width: 1200px) { .module-grid { grid-template-columns: 1fr; } .module-card.wide { grid-column: span 1; } .stats-grid { grid-template-columns: 1fr 1fr; } .pricing-grid { grid-template-columns: 1fr; } .metric-cards { grid-template-columns: 1fr 1fr; } }
        @media (max-width: 768px) { .app-container { grid-template-columns: 1fr; } .sidebar { display: none; } .main-content { margin-left: 0; } .form-row { grid-template-columns: 1fr; } }
    </style>
</head>
<body>
    <div class="bg-animation"></div>
    
    <div class="modal-overlay" id="upgradeModal">
        <div class="modal">
            <div class="modal-header">
                <div>
                    <h2>Unlock NutriSync Pro</h2>
                    <p style="color: rgba(255,255,255,0.5); margin-top: 0.5rem;">Choose your access method</p>
                </div>
                <button class="btn btn-glass" onclick="closeModal()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <div class="access-code-section">
                <h3><i class="fas fa-key"></i> Have an Access Code?</h3>
                <p style="font-size: 0.875rem; color: rgba(255,255,255,0.6); margin-bottom: 1rem;">Enter your architect code for unlimited free Pro access</p>
                <input type="text" class="access-input" id="accessCodeInput" placeholder="architect_x_2025" onkeyup="checkAccessCode(event)">
                <button class="btn btn-premium" style="width: 100%;" onclick="verifyAccessCode()">
                    <i class="fas fa-unlock"></i> Unlock with Code
                </button>
                <div id="accessMessage" style="margin-top: 0.75rem; font-size: 0.875rem; text-align: center;"></div>
            </div>

            <div style="text-align: center; padding: 1rem; color: rgba(255,255,255,0.4); font-size: 0.875rem;">â€” OR â€”</div>
            
            <div class="pricing-grid" style="padding-top: 0;">
                <div class="pricing-card" onclick="selectPlan('free')">
                    <h3>Starter</h3>
                    <div class="price">$0<span>/month</span></div>
                    <ul style="list-style: none; margin-top: 1.5rem; display: grid; gap: 0.75rem;">
                        <li style="font-size: 0.9rem; color: rgba(255,255,255,0.7);"><i class="fas fa-check" style="color: var(--secondary); margin-right: 0.5rem;"></i> Basic tracking</li>
                        <li style="font-size: 0.9rem; color: rgba(255,255,255,0.4);"><i class="fas fa-times" style="margin-right: 0.5rem;"></i> Advanced charts</li>
                        <li style="font-size: 0.9rem; color: rgba(255,255,255,0.4);"><i class="fas fa-times" style="margin-right: 0.5rem;"></i> AI Coach</li>
                    </ul>
                </div>

                <div class="pricing-card popular selected" onclick="selectPlan('pro')">
                    <h3>Pro Ecosystem</h3>
                    <div class="price">$15<span>/month</span></div>
                    <ul style="list-style: none; margin-top: 1.5rem; display: grid; gap: 0.75rem;">
                        <li style="font-size: 0.9rem; color: rgba(255,255,255,0.7);"><i class="fas fa-check" style="color: var(--secondary); margin-right: 0.5rem;"></i> Unlimited everything</li>
                        <li style="font-size: 0.9rem; color: rgba(255,255,255,0.7);"><i class="fas fa-check" style="color: var(--secondary); margin-right: 0.5rem;"></i> All charts & goals</li>
                        <li style="font-size: 0.9rem; color: rgba(255,255,255,0.7);"><i class="fas fa-check" style="color: var(--secondary); margin-right: 0.5rem;"></i> AI Personal Coach</li>
                    </ul>
                </div>
            </div>

            <div style="padding: 0 2rem 2rem;">
                <div id="paymentForm" style="display: none;">
                    <label style="font-size: 0.875rem; color: rgba(255,255,255,0.7);">Card Details</label>
                    <div id="card-element"></div>
                    <div id="card-errors" style="color: var(--danger); font-size: 0.875rem; margin-top: 0.5rem;"></div>
                </div>
                
                <button class="btn btn-primary" style="width: 100%; margin-top: 1.5rem; padding: 1rem; display: none;" onclick="processPayment()" id="payButton">
                    <i class="fas fa-credit-card"></i> Pay $15/month
                </button>
            </div>
        </div>
    </div>

    <div class="app-container">
        <aside class="sidebar">
            <div class="brand">
                <div class="brand-icon"><i class="fas fa-atom"></i></div>
                <div class="brand-text">
                    <h1>NutriSync</h1>
                    <span>CLINICAL ECOSYSTEM v2.0</span>
                </div>
            </div>

            <nav>
                <div class="nav-section">Core</div>
                <div class="nav-item active" onclick="switchTab('dashboard')">
                    <i class="fas fa-th-large"></i>
                    <span>Command Center</span>
                </div>
                <div class="nav-item" onclick="switchTab('profile')">
                    <i class="fas fa-user-circle"></i>
                    <span>Profile & Goals</span>
                </div>
                <div class="nav-item" onclick="switchTab('body')">
                    <i class="fas fa-weight"></i>
                    <span>Body Metrics</span>
                </div>
                <div class="nav-item" onclick="switchTab('nutrition')">
                    <i class="fas fa-dna"></i>
                    <span>Smart Nutrition</span>
                </div>
                <div class="nav-item" onclick="switchTab('fitness')">
                    <i class="fas fa-dumbbell"></i>
                    <span>Elite Fitness</span>
                </div>
                <div class="nav-item" onclick="switchTab('mind')">
                    <i class="fas fa-brain"></i>
                    <span>Mind & Breath</span>
                </div>

                <div class="nav-section">Pro Features</div>
                <div class="nav-item premium" id="navFamily" onclick="checkProAccess('family')">
                    <i class="fas fa-users"></i>
                    <span>Family Network</span>
                </div>
                <div class="nav-item premium" id="navReports" onclick="checkProAccess('reports')">
                    <i class="fas fa-file-medical"></i>
                    <span>Clinical Reports</span>
                </div>
                <div class="nav-item premium" id="navVR" onclick="checkProAccess('vr')">
                    <i class="fas fa-vr-cardboard"></i>
                    <span>VR Training</span>
                </div>
            </nav>

            <div class="feature-count">
                <div class="feature-count-box">
                    <h4>Active Features</h4>
                    <div class="number" id="featureCount">12</div>
                    <div style="font-size: 0.75rem; color: rgba(255,255,255,0.4); margin-top: 0.25rem;">of 274 available</div>
                </div>
            </div>
        </aside>

        <main class="main-content">
            <!-- DASHBOARD -->
            <div id="dashboardTab">
                <div class="top-header">
                    <div class="page-title">
                        <h2>Command Center</h2>
                        <p>Your health ecosystem at a glance</p>
                    </div>
                    <div class="header-actions">
                        <button class="btn btn-glass" onclick="openUpgradeModal()">
                            <i class="fas fa-key"></i> Enter Code
                        </button>
                        <button class="btn btn-primary" id="upgradeBtn" onclick="openUpgradeModal()">
                            <i class="fas fa-crown"></i> Upgrade to Pro
                        </button>
                    </div>
                </div>

                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-header">
                            <span class="stat-label">Current Weight</span>
                            <div class="stat-icon blue"><i class="fas fa-weight"></i></div>
                        </div>
                        <div class="stat-value" id="dashWeight">--</div>
                        <div class="stat-change">Set up your profile</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-header">
                            <span class="stat-label">Goal Weight</span>
                            <div class="stat-icon green"><i class="fas fa-bullseye"></i></div>
                        </div>
                        <div class="stat-value" id="dashGoal">--</div>
                        <div class="stat-change" id="dashToGo">-- lbs to go</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-header">
                            <span class="stat-label">BMI</span>
                            <div class="stat-icon purple"><i class="fas fa-calculator"></i></div>
                        </div>
                        <div class="stat-value" id="dashBMI">--</div>
                        <div class="stat-change" id="dashBMICat">Calculate in profile</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-header">
                            <span class="stat-label">Age</span>
                            <div class="stat-icon orange"><i class="fas fa-birthday-cake"></i></div>
                        </div>
                        <div class="stat-value" id="dashAge">--</div>
                        <div class="stat-change">years old</div>
                    </div>
                </div>

                <div class="module-grid">
                    <div class="module-card wide">
                        <div class="module-header">
                            <div class="module-title">
                                <div class="module-icon"><i class="fas fa-chart-line"></i></div>
                                <div>
                                    <h3>Weight Progress</h3>
                                    <span>Track your journey to goal</span>
                                </div>
                            </div>
                        </div>
                        <div class="chart-container">
                            <canvas id="weightChart"></canvas>
                        </div>
                    </div>

                    <div class="module-card">
                        <div class="module-header">
                            <div class="module-title">
                                <div class="module-icon" style="background: linear-gradient(135deg, #00D4AA 0%, #0066FF 100%);"><i class="fas fa-wind"></i></div>
                                <div><h3>Neuro-Breathing</h3><span>DeepBreathe Integration</span></div>
                            </div>
                        </div>
                        <div class="world-first-badge"><i class="fas fa-lungs"></i> WORLD FIRST: HRV-Optimized</div>
                        <div class="breathing-container">
                            <div class="breath-circle"><span>Start</span></div>
                            <div class="breath-controls">
                                <button class="breath-btn active">Relax</button>
                                <button class="breath-btn">Sleep</button>
                                <button class="breath-btn">Energy</button>
                            </div>
                        </div>
                    </div>

                    <div class="module-card">
                        <div class="module-header">
                            <div class="module-title">
                                <div class="module-icon" style="background: linear-gradient(135deg, #FF4757 0%, #FFA502 100%);"><i class="fas fa-running"></i></div>
                                <div><h3>Elite Training</h3><span>Multi-modal workouts</span></div>
                            </div>
                        </div>
                        <div class="world-first-badge"><i class="fas fa-trophy"></i> WORLD FIRST: AI Form Correction</div>
                        <div class="workout-categories">
                            <div class="workout-cat"><i class="fas fa-spa" style="color: var(--secondary);"></i><h4>Yoga</h4></div>
                            <div class="workout-cat"><i class="fas fa-fire-alt" style="color: var(--danger);"></i><h4>HIIT</h4></div>
                            <div class="workout-cat"><i class="fas fa-dumbbell" style="color: var(--primary);"></i><h4>Strength</h4></div>
                            <div class="workout-cat"><i class="fas fa-yin-yang" style="color: var(--accent);"></i><h4>Tai Chi</h4></div>
                            <div class="workout-cat"><i class="fas fa-female" style="color: #ff6b9d;"></i><h4>Pilates</h4></div>
                            <div class="workout-cat"><i class="fas fa-hand-rock" style="color: var(--warning);"></i><h4>Boxing</h4></div>
                        </div>
                    </div>

                    <div class="module-card" style="border: 2px solid rgba(255,215,0,0.3);">
                        <div class="premium-overlay" id="proOverlay">
                            <i class="fas fa-crown premium-icon"></i>
                            <h3>274 Pro Features Locked</h3>
                            <p style="color: rgba(255,255,255,0.6); padding: 0 2rem;">
                                Unlock DNA analysis, VR training, family networks, and clinical-grade reporting
                            </p>
                            <button class="btn btn-premium" onclick="openUpgradeModal()">
                                <i class="fas fa-unlock"></i> Unlock Now
                            </button>
                        </div>
                        <div class="module-header">
                            <div class="module-title">
                                <div class="module-icon" style="background: var(--gradient-premium); color: black;"><i class="fas fa-star"></i></div>
                                <div><h3 style="color: #FFD700;">Pro Suite</h3><span>Clinical grade tools</span></div>
                            </div>
                        </div>
                        <div style="padding: 2rem; text-align: center; color: rgba(255,255,255,0.3);">
                            <i class="fas fa-lock" style="font-size: 3rem; margin-bottom: 1rem;"></i>
                            <p>Upgrade to access all features</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- PROFILE TAB -->
            <div id="profileTab" class="hidden">
                <div class="top-header">
                    <div class="page-title">
                        <h2>Profile & Goals</h2>
                        <p>Set up your body metrics and targets</p>
                    </div>
                </div>
                
                <div class="module-card" style="max-width: 800px;">
                    <div class="module-header">
                        <div class="module-title">
                            <div class="module-icon"><i class="fas fa-user-edit"></i></div>
                            <div><h3>Your Information</h3><span>Required for accurate tracking</span></div>
                        </div>
                    </div>
                    
                    <form class="profile-form" onsubmit="saveProfile(event)">
                        <div class="form-row">
                            <div class="form-group">
                                <label>Current Weight (lbs)</label>
                                <input type="number" id="currentWeight" placeholder="185" required>
                            </div>
                            <div class="form-group">
                                <label>Goal Weight (lbs)</label>
                                <input type="number" id="goalWeight" placeholder="165" required>
                            </div>
                        </div>
                        
                        <div class="form-row">
                            <div class="form-group">
                                <label>Height (inches)</label>
                                <input type="number" id="height" placeholder="70" required>
                            </div>
                            <div class="form-group">
                                <label>Age (years)</label>
                                <input type="number" id="age" placeholder="32" required>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label>Gender</label>
                            <select id="gender" style="padding: 0.75rem 1rem; background: rgba(0,0,0,0.3); border: 1px solid rgba(255,255,255,0.2); border-radius: 8px; color: white; font-size: 1rem;">
                                <option value="">Select...</option>
                                <option value="male">Male</option>
                                <option value="female">Female</option>
                                <option value="other">Other</option>
                            </select>
                        </div>
                        
                        <button type="submit" class="btn btn-primary" style="width: 100%; margin-top: 1rem;">
                            <i class="fas fa-save"></i> Save Profile & Calculate BMI
                        </button>
                    </form>
                    
                    <div id="profileResult" style="margin-top: 1.5rem; padding: 1rem; background: rgba(0,212,170,0.1); border-radius: 8px; display: none;">
                        <div style="display: flex; align-items: center; gap: 0.5rem; color: var(--secondary); margin-bottom: 0.5rem;">
                            <i class="fas fa-check-circle"></i>
                            <strong>Profile Saved!</strong>
                        </div>
                        <p style="color: rgba(255,255,255,0.7); font-size: 0.9rem;">Your BMI and goals have been calculated. Check the Body Metrics tab for charts.</p>
                    </div>
                </div>
            </div>

            <!-- BODY METRICS TAB -->
            <div id="bodyTab" class="hidden">
                <div class="top-header">
                    <div class="page-title">
                        <h2>Body Metrics</h2>
                        <p>Visualize your progress</p>
                    </div>
                </div>
                
                <div class="metric-cards">
                    <div class="metric-card">
                        <div class="metric-value" id="metricWeight">--</div>
                        <div class="metric-label">Current Weight (lbs)</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-value" id="metricGoal">--</div>
                        <div class="metric-label">Goal Weight (lbs)</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-value" id="metricBMI">--</div>
                        <div class="metric-label">BMI</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-value" id="metricProgress">--</div>
                        <div class="metric-label">Progress %</div>
                    </div>
                </div>

                <div class="module-card">
                    <div class="module-header">
                        <div class="module-title">
                            <div class="module-icon"><i class="fas fa-chart-area"></i></div>
                            <div><h3>Weight Journey</h3><span>Current vs Goal over time</span></div>
                        </div>
                    </div>
                    <div class="chart-container" style="height: 400px;">
                        <canvas id="bodyChart"></canvas>
                    </div>
                </div>

                <div class="module-card wide" style="margin-top: 1.5rem;">
                    <div class="module-header">
                        <div class="module-title">
                            <div class="module-icon"><i class="fas fa-ruler-vertical"></i></div>
                            <div><h3>Log Today's Weight</h3><span>Track your daily progress</span></div>
                        </div>
                    </div>
                    <div style="display: flex; gap: 1rem; align-items: flex-end;">
                        <div class="form-group" style="flex: 1;">
                            <label>Today's Weight (lbs)</label>
                            <input type="number" id="logWeight" placeholder="Enter weight...">
                        </div>
                        <button class="btn btn-primary" onclick="logWeight()">
                            <i class="fas fa-plus"></i> Log Entry
                        </button>
                    </div>
                </div>
            </div>

            <!-- OTHER TABS -->
            <div id="nutritionTab" class="hidden">
                <div class="top-header">
                    <div class="page-title"><h2>Smart Nutrition</h2><p>AI-powered metabolic optimization</p></div>
                </div>
                <div class="module-card" style="padding: 4rem; text-align: center;">
                    <i class="fas fa-utensils" style="font-size: 4rem; color: var(--primary); margin-bottom: 1rem; opacity: 0.3;"></i>
                    <h3>Nutrition Dashboard</h3>
                    <p style="color: rgba(255,255,255,0.5);">Log your first meal to see your nutrition analytics</p>
                </div>
            </div>

            <div id="fitnessTab" class="hidden">
                <div class="top-header">
                    <div class="page-title"><h2>Elite Fitness</h2><p>World-class training protocols</p></div>
                </div>
                <div class="module-card" style="padding: 4rem; text-align: center;">
                    <i class="fas fa-dumbbell" style="font-size: 4rem; color: var(--danger); margin-bottom: 1rem; opacity: 0.3;"></i>
                    <h3>Workout Library</h3>
                    <p style="color: rgba(255,255,255,0.5);">Select a workout category to begin your training</p>
                </div>
            </div>

            <div id="mindTab" class="hidden">
                <div class="top-header">
                    <div class="page-title"><h2>Mind & Breath</h2><p>Mental clarity & stress management</p></div>
                </div>
                <div class="module-card" style="padding: 4rem; text-align: center;">
                    <i class="fas fa-wind" style="font-size: 4rem; color: var(--secondary); margin-bottom: 1rem; opacity: 0.3;"></i>
                    <h3>Mindfulness Center</h3>
                    <p style="color: rgba(255,255,255,0.5);">Start a breathing session to track your mindfulness</p>
                </div>
            </div>
        </main>
    </div>

    <script>
        // Initialize user data
        let userData = {
            weight: null,
            goalWeight: null,
            height: null,
            age: null,
            gender: null,
            bmi: null,
            weightHistory: [],
            isPremium: false
        };
        
        let weightChartInstance = null;
        let bodyChartInstance = null;

        const STRIPE_KEY = 'pk_test_51SnApvGonKjAFVYNhPHWMmD0DwMbSe9WREWER2lrlgVzY4mIKEr5oGStBCiaZSJrpkSz9w6etBvv1NxqDu2xNTrp00aEXqOehJ';
        const stripe = Stripe(STRIPE_KEY);
        const elements = stripe.elements();
        let cardElement = null;

        // Check for saved premium status
        if (localStorage.getItem('nutrisync_premium') === 'true') {
            activatePro();
        }

        function switchTab(tab) {
            document.querySelectorAll('[id$="Tab"]').forEach(el => el.classList.add('hidden'));
            document.getElementById(tab + 'Tab').classList.remove('hidden');
            document.querySelectorAll('.nav-item').forEach(el => el.classList.remove('active'));
            event.target.closest('.nav-item').classList.add('active');
            
            if (tab === 'body') {
                updateBodyCharts();
            }
        }

        function checkProAccess(feature) {
            if (!userData.isPremium) {
                openUpgradeModal();
            } else {
                showToast('âœ“ Pro Feature Unlocked: ' + feature, 'success');
            }
        }

        function openUpgradeModal() {
            document.getElementById('upgradeModal').classList.add('active');
            if (!cardElement) {
                cardElement = elements.create('card', {
                    style: { base: { fontSize: '16px', color: '#ffffff', '::placeholder': { color: '#6b7280' } } }
                });
                cardElement.mount('#card-element');
                cardElement.on('change', (e) => {
                    document.getElementById('card-errors').textContent = e.error ? e.error.message : '';
                });
            }
        }

        function closeModal() {
            document.getElementById('upgradeModal').classList.remove('active');
            document.getElementById('accessMessage').textContent = '';
            document.getElementById('accessCodeInput').value = '';
        }

        function checkAccessCode(e) {
            if (e.key === 'Enter') verifyAccessCode();
        }

        function verifyAccessCode() {
            const input = document.getElementById('accessCodeInput');
            const code = input.value.trim();
            const msg = document.getElementById('accessMessage');
            
            if (code === 'architect_x_2025') {
                msg.innerHTML = '<span style="color: var(--secondary);"><i class="fas fa-check-circle"></i> Code accepted! Activating Pro...</span>';
                setTimeout(() => {
                    activatePro();
                    closeModal();
                    showToast('ðŸŽ‰ Architect Access Granted! All 274 Pro Features Unlocked Forever!', 'success');
                }, 1500);
            } else {
                msg.innerHTML = '<span style="color: var(--danger);"><i class="fas fa-times-circle"></i> Invalid code. Try: architect_x_2025</span>';
                input.style.borderColor = 'var(--danger)';
                setTimeout(() => { input.style.borderColor = ''; }, 2000);
            }
        }

        function activatePro() {
            userData.isPremium = true;
            localStorage.setItem('nutrisync_premium', 'true');
            
            // Hide premium overlays
            const overlay = document.getElementById('proOverlay');
            if (overlay) {
                overlay.classList.add('hidden-overlay');
                setTimeout(() => {
                    overlay.style.display = 'none';
                }, 300);
            }
            
            // Update feature count
            document.getElementById('featureCount').textContent = '274';
            
            // Update upgrade button
            const upgradeBtn = document.getElementById('upgradeBtn');
            if (upgradeBtn) {
                upgradeBtn.innerHTML = '<i class="fas fa-check"></i> Pro Active';
                upgradeBtn.classList.remove('btn-primary');
                upgradeBtn.classList.add('btn-success');
                upgradeBtn.onclick = null;
            }
            
            // Unlock nav items
            ['navFamily', 'navReports', 'navVR'].forEach(id => {
                const item = document.getElementById(id);
                if (item) {
                    item.classList.remove('premium');
                    item.classList.add('unlocked');
                }
            });
            
            // Show success state in all premium cards
            document.querySelectorAll('.premium-overlay').forEach(el => {
                el.innerHTML = '<div style="color: var(--secondary); font-size: 1.2rem;"><i class="fas fa-check-circle" style="font-size: 3rem; margin-bottom: 1rem;"></i><br>âœ“ UNLOCKED</div>';
                setTimeout(() => {
                    el.classList.add('hidden-overlay');
                    setTimeout(() => el.style.display = 'none', 300);
                }, 1000);
            });
        }

        function selectPlan(plan) {
            document.querySelectorAll('.pricing-card').forEach(c => c.classList.remove('selected'));
            event.target.closest('.pricing-card').classList.add('selected');
            
            const payForm = document.getElementById('paymentForm');
            const payBtn = document.getElementById('payButton');
            
            if (plan === 'pro') {
                payForm.style.display = 'block';
                payBtn.style.display = 'block';
            } else {
                payForm.style.display = 'none';
                payBtn.style.display = 'none';
            }
        }

        async function processPayment() {
            const btn = document.getElementById('payButton');
            btn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Processing...';
            btn.disabled = true;
            
            try {
                const { paymentMethod, error } = await stripe.createPaymentMethod({
                    type: 'card',
                    card: cardElement,
                    billing_details: { name: 'User', email: 'user@example.com' }
                });
                
                if (error) throw error;
                
                setTimeout(() => {
                    activatePro();
                    closeModal();
                    showToast('Welcome to NutriSync Pro!', 'success');
                }, 2000);
            } catch (err) {
                showToast(err.message, 'error');
                btn.innerHTML = '<i class="fas fa-credit-card"></i> Pay $15/month';
                btn.disabled = false;
            }
        }

        function saveProfile(e) {
            e.preventDefault();
            
            userData.weight = parseFloat(document.getElementById('currentWeight').value);
            userData.goalWeight = parseFloat(document.getElementById('goalWeight').value);
            userData.height = parseFloat(document.getElementById('height').value);
            userData.age = parseInt(document.getElementById('age').value);
            userData.gender = document.getElementById('gender').value;
            
            // Calculate BMI
            const heightM = userData.height * 0.0254;
            userData.bmi = (userData.weight / (heightM * heightM)).toFixed(1);
            
            // Save to localStorage
            localStorage.setItem('nutrisync_profile', JSON.stringify(userData));
            
            // Show success
            document.getElementById('profileResult').style.display = 'block';
            
            // Update dashboard
            updateDashboard();
            
            showToast('Profile saved! BMI: ' + userData.bmi, 'success');
        }

        function updateDashboard() {
            if (userData.weight) {
                document.getElementById('dashWeight').textContent = userData.weight;
                document.getElementById('metricWeight').textContent = userData.weight;
            }
            if (userData.goalWeight) {
                document.getElementById('dashGoal').textContent = userData.goalWeight;
                document.getElementById('metricGoal').textContent = userData.goalWeight;
                
                const toGo = userData.weight - userData.goalWeight;
                document.getElementById('dashToGo').textContent = toGo + ' lbs to go';
            }
            if (userData.bmi) {
                document.getElementById('dashBMI').textContent = userData.bmi;
                document.getElementById('metricBMI').textContent = userData.bmi;
                
                let category = '';
                if (userData.bmi < 18.5) category = 'Underweight';
                else if (userData.bmi < 25) category = 'Healthy';
                else if (userData.bmi < 30) category = 'Overweight';
                else category = 'Obese';
                
                document.getElementById('dashBMICat').textContent = category;
            }
            if (userData.age) {
                document.getElementById('dashAge').textContent = userData.age;
            }
            
            updateProgress();
        }

        function updateProgress() {
            if (userData.weight && userData.goalWeight) {
                const totalToLose = userData.weight - userData.goalWeight;
                const startWeight = userData.weightHistory.length > 0 ? Math.max(...userData.weightHistory.map(w => w.weight)) : userData.weight;
                const currentLost = startWeight - userData.weight;
                const progress = Math.max(0, Math.min(100, (currentLost / totalToLose) * 100)).toFixed(1);
                document.getElementById('metricProgress').textContent = progress + '%';
            }
        }

        function logWeight() {
            const weight = parseFloat(document.getElementById('logWeight').value);
            if (!weight) return;
            
            userData.weight = weight;
            userData.weightHistory.push({
                date: new Date().toISOString().split('T')[0],
                weight: weight
            });
            
            localStorage.setItem('nutrisync_profile', JSON.stringify(userData));
            updateDashboard();
            updateBodyCharts();
            
            document.getElementById('logWeight').value = '';
            showToast('Weight logged: ' + weight + ' lbs', 'success');
        }

        function updateBodyCharts() {
            if (!userData.weightHistory.length && !userData.weight) return;
            
            const ctx = document.getElementById('bodyChart').getContext('2d');
            
            // Prepare data
            let labels = userData.weightHistory.map(w => w.date);
            let weights = userData.weightHistory.map(w => w.weight);
            
            // Add current weight if not in history
            if (userData.weight && (!weights.length || weights[weights.length - 1] !== userData.weight)) {
                labels.push(new Date().toISOString().split('T')[0]);
                weights.push(userData.weight);
            }
            
            // Generate goal line
            const goalLine = Array(weights.length).fill(userData.goalWeight || 0);
            
            if (bodyChartInstance) {
                bodyChartInstance.destroy();
            }
            
            bodyChartInstance = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: labels,
                    datasets: [{
                        label: 'Weight (lbs)',
                        data: weights,
                        borderColor: '#0066FF',
                        backgroundColor: 'rgba(0, 102, 255, 0.1)',
                        fill: true,
                        tension: 0.4
                    }, {
                        label: 'Goal (lbs)',
                        data: goalLine,
                        borderColor: '#00D4AA',
                        borderDash: [5, 5],
                        fill: false
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { labels: { color: 'white' } }
                    },
                    scales: {
                        y: {
                            ticks: { color: 'rgba(255,255,255,0.7)' },
                            grid: { color: 'rgba(255,255,255,0.1)' }
                        },
                        x: {
                            ticks: { color: 'rgba(255,255,255,0.7)' },
                            grid: { color: 'rgba(255,255,255,0.1)' }
                        }
                    }
                }
            });
        }

        function showToast(message, type) {
            const toast = document.createElement('div');
            toast.style.cssText = `position: fixed; top: 20px; right: 20px; padding: 1rem 1.5rem; background: ${type === 'success' ? 'rgba(0, 212, 170, 0.9)' : 'rgba(255, 71, 87, 0.9)'}; color: white; border-radius: 10px; font-weight: 600; z-index: 10000; animation: slideIn 0.3s ease;`;
            toast.innerHTML = message;
            document.body.appendChild(toast);
            setTimeout(() => { toast.style.opacity = '0'; setTimeout(() => toast.remove(), 300); }, 4000);
        }

        // Load saved data on startup
        window.addEventListener('load', () => {
            const saved = localStorage.getItem('nutrisync_profile');
            if (saved) {
                userData = JSON.parse(saved);
                updateDashboard();
                
                // Fill form
                if (userData.weight) document.getElementById('currentWeight').value = userData.weight;
                if (userData.goalWeight) document.getElementById('goalWeight').value = userData.goalWeight;
                if (userData.height) document.getElementById('height').value = userData.height;
                if (userData.age) document.getElementById('age').value = userData.age;
                if (userData.gender) document.getElementById('gender').value = userData.gender;
            }
        });

        document.getElementById('upgradeModal').addEventListener('click', (e) => {
            if (e.target === e.currentTarget) closeModal();
        });
    </script>
</body>
</html>'''
